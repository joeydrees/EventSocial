<div class="off-canvas-wrap show-for-small-only mobile-events-menu" data-offcanvas data-equalizer>
	<div class="inner-wrap">
		<nav class="tab-bar">
		  	<section class="left-small">
		    	<a class="left-off-canvas-toggle menu-icon button" href="#"><span></span></a>
		  	</section>
		</nav>

		<aside class="left-off-canvas-menu" data-equalizer-watch>
			<%= render 'events/manage_events_sidebar_mobile' %>
		</aside>

		<section class="middle tab-bar-section">
		    <h6 class="title events-off-canvas">My Events</h1>
		</section>

		<section class="main-section display-tweets-mobile 12-columns" data-equalizer-watch>
			<div class="row">
				<div class="small-12 columns">
					<h2><%= @event.name %></h2>
					<br />
					<h3>Tweets</h3>
					<% if @tweets.empty? %>
						<h4 class="no-tweets">There are currently no tweets for this event.</h4>
					<% else %>
						<table id="tweets-mobile" class="display responsive nowrap" cellspacing="0" width="100%">
				            <thead>
				                <tr>
				                    <th>Tweet</th>
				                    <th class="hidden">Date Created</th>
				                    <th>Approve</th>
				                    <th>Delete</th>
				                </tr>
				            </thead>
				            <tfoot></tfoot>
				            <tbody>
				                <% @tweets.each do |tweet| %>
				                    <tr>
				                        <td style="width:75px;"><%= tweet.text %></td>
				                        <td class="hidden"><%= tweet.tweet_created_at.in_time_zone('Eastern Time (US & Canada)').strftime("%B %d, %Y @ %I:%M %p") %></td>
				                        <td><%= link_to image_tag("thumbs-up.png"), event_manage_event_path(@event, tweet), method: :put, class: "comment-icons approve-icon" %></td>
				                        <td><%= link_to image_tag("delete-icon.png"), delete_tweet_event_manage_event_path(@event, tweet), method: :put, class: "comment-icons delete-icon" %></td>
				                    </tr>
				                <% end %>
				            </tbody>
				        </table>
				    <% end %>
				    <br />
				    <h3>Comments</h3>
					<% if @comments.empty? %>
						<h4 class="no-tweets">There are currently no comments for this event.</h4>
					<% else %>
						<table id="comments-mobile" class="display responsive nowrap" cellspacing="0" width="100%">
				            <thead>
				                <tr>
				                    <th>Username</th>
				                    <th>Comment</th>
				                    <th class="hidden">Date Created</th>
				                    <th>Approve</th>
				                    <th>Delete</th>
				                </tr>
				            </thead>
				            <tfoot></tfoot>
				            <tbody>
				                <% @comments.each do |comment| %>
				                    <tr>
				                    	<% if User.find(comment.user_id).email.blank? %>
				                        	<td><%= User.find(comment.user_id).username %></td>
				                        <% else %>
				                        	<td><%= User.find(comment.user_id).email %></td>
				                        <% end %>
				                        <td><%= comment.comment %></td>
				                        <td class="hidden"><%= comment.created_at.in_time_zone('Eastern Time (US & Canada)').strftime("%B %d, %Y @ %I:%M %p") %></td>
				                        <td><%= link_to image_tag("thumbs-up.png"), event_comment_path(@event, comment), method: :put, class: "comment-icons" %></td>
				                        <td><%= link_to image_tag("delete-icon.png"), event_comment_path(@event, comment), method: :delete, class: "comment-icons" %></td>
				                    </tr>
				                <% end %>
				            </tbody>
				        </table>
				    <% end %>
				</div>
			</div>
		</section>

		<a class="exit-off-canvas"></a>
	</div>
</div>

<div class="row show-for-medium-up">
	<div class="medium-3 columns">
		<%= render 'events/manage_events_sidebar' %>
	</div>
	<div class="medium-9 columns display-tweets-desktop">
		<h2><%= @event.name %></h2>
		<br />
		<h3>Tweets</h3>
		<% if @tweets.empty? %>
			<h4 class="no-tweets">There are currently no tweets for this event.</h4>
		<% else %>
			<table id="tweets" class="display responsive nowrap manage-tweets-table" cellspacing="0" width="100%">
	            <thead>
	                <tr>
	                    <th>Tweet</th>
	                    <th class="hidden">Date Created</th>
	                    <th>Approve</th>
	                    <th>Delete</th>
	                    <th>Tweet</th>
	                </tr>
	            </thead>
	            <tfoot></tfoot>
	            <tbody>
	                <% @tweets.each do |tweet| %>
	                    <tr>
	                        <td><%= tweet.text %></td>
	                        <td class="hidden"><%= tweet.tweet_created_at.in_time_zone('Eastern Time (US & Canada)').strftime("%B %d, %Y @ %I:%M %p") %></td>
	                        <td><%= link_to image_tag("thumbs-up.png"), event_manage_event_path(@event, tweet), method: :put, class: "comment-icons approve-icon" %></td>
	                        <td><%= link_to image_tag("delete-icon.png"), delete_tweet_event_manage_event_path(@event, tweet), method: :put, class: "comment-icons delete-icon" %></td>
	                        <td><%= tweet.text %></td>
	                    </tr>
	                <% end %>
	            </tbody>
	        </table>
	    <% end %>
	    <br />
	    <h3>Comments</h3>
		<% if @comments.empty? %>
			<h4 class="no-tweets">There are currently no comments for this event.</h4>
		<% else %>
			<table id="comments" class="display responsive nowrap" cellspacing="0" width="100%">
	            <thead>
	                <tr>
	                    <th>Username</th>
	                    <th>Comment</th>
	                    <th class="hidden">Date Created</th>
	                    <th>Approve</th>
	                    <th>Delete</th>
	                </tr>
	            </thead>
	            <tfoot></tfoot>
	            <tbody>
	                <% @comments.each do |comment| %>
	                    <tr>
	                    	<% if User.find(comment.user_id).email.blank? %>
	                        	<td><%= User.find(comment.user_id).username %></td>
	                        <% else %>
	                        	<td><%= User.find(comment.user_id).email %></td>
	                        <% end %>
	                        <td><%= comment.comment %></td>
	                        <td class="hidden"><%= comment.created_at.in_time_zone('Eastern Time (US & Canada)').strftime("%B %d, %Y @ %I:%M %p") %></td>
	                        <td><%= link_to image_tag("thumbs-up.png"), event_comment_path(@event, comment), method: :put, class: "comment-icons" %></td>
	                        <td><%= link_to image_tag("delete-icon.png"), event_comment_path(@event, comment), method: :delete, class: "comment-icons" %></td>
	                    </tr>
	                <% end %>
	            </tbody>
	        </table>
	    <% end %>
	</div>
</div>

<script>
	$(document).ready(function() {
	    $('#tweets').DataTable({
            "order": [3, 'desc'],
            "lengthMenu": [5, 10, 15, 20, 25],
            "columnDefs": [{ "orderable": false, "targets": [0,1,2,3] }],
        });

        $('#comments').DataTable({
            "order": [2, 'desc'],
            "columnDefs": [{ "orderable": false, "targets": [0,1,2,3,4] }],
        });

        $('#tweets-mobile').DataTable({
            "order": [3, 'desc'],
            "lengthMenu": [5, 10, 15, 20, 25],
            "columnDefs": [{ "orderable": false, "targets": [0,1,2,3] }],
        });

        $('#comments-mobile').DataTable({
            "order": [2, 'desc'],
            "columnDefs": [{ "orderable": false, "targets": [0,1,2,3,4] }],
        });
	});
</script>

<script>
	$(function() {
		var activeEventHashtag = "<%= Event.find(params[:event_id]).hashtag %>";
		
		var myEventsListItems = $("#my-events-list li");
		addActiveClass(myEventsListItems, activeEventHashtag);

		var subscriptionsListItems = $("#subscriptions-list li");
		addActiveClass(subscriptionsListItems, activeEventHashtag);
		
		var mobileListItems = $("#mobile-events-list li");
		addActiveClassMobile(mobileListItems, activeEventHashtag);
	});

	var addActiveClass = function(listItems, activeEventHashtag) {
		listItems.each(function(index, li) {
    		var eventHashtag = $(li).text().substring(1);
    		if (eventHashtag.trim().toLowerCase() == activeEventHashtag.trim().toLowerCase()) {
    			$(li).addClass("active");
    		}
		});
	};

	var addActiveClassMobile = function(listItems, activeEventHashtag) {
		listItems.each(function(index, li) {
    		var eventHashtag = $(li).text().substring(1);
    		if (eventHashtag.trim().toLowerCase() == activeEventHashtag.trim().toLowerCase()) {
    			$(li).children().addClass("active");
    		}
		});
	};
</script>